{{- if not .Values.externalSecret.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "coseal.fullname" . }}-secret
  labels:
    {{- include "coseal.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.database.url }}
  DATABASE_URL: {{ .Values.database.url | quote }}
  {{- else }}
  DATABASE_URL: "postgresql://{{ .Values.database.user }}:{{ .Values.database.password }}@{{ .Values.database.host }}:{{ .Values.database.port }}/{{ .Values.database.name }}{{ if .Values.database.ssl }}?sslmode=require{{ end }}"
  {{- end }}
  ENCRYPTION_KEY: {{ .Values.encryption.key | quote }}
  API_KEY: {{ .Values.auth.apiKey | quote }}
  {{- if .Values.storage.accessKeyId }}
  S3_ACCESS_KEY_ID: {{ .Values.storage.accessKeyId | quote }}
  S3_SECRET_ACCESS_KEY: {{ .Values.storage.secretAccessKey | quote }}
  {{- end }}
  {{- if .Values.email.sendgridApiKey }}
  SENDGRID_API_KEY: {{ .Values.email.sendgridApiKey | quote }}
  {{- end }}
  {{- if .Values.sms.twilioAccountSid }}
  TWILIO_ACCOUNT_SID: {{ .Values.sms.twilioAccountSid | quote }}
  TWILIO_AUTH_TOKEN: {{ .Values.sms.twilioAuthToken | quote }}
  TWILIO_FROM_NUMBER: {{ .Values.sms.twilioFromNumber | quote }}
  {{- end }}
{{- end }}
